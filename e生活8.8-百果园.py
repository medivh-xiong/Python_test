import requests
import time
import datetime

cookies = {
    'ARK_ID': 'JS48539a3286cc77e856a810f11b16dec34853',
    'FZ_STROAGE.ofpay.com': 'eyJBUktTVVBFUiI6eyJncHNfY2l0eSI6IiIsInByb2plY3RfdHlwZSI6IueIsei0rTguOOa0u%2BWKqCJ9LCJTRUVTSU9OSUQiOiI0NmRkZGYwOTYyZWZhYjI1IiwiU0VFU0lPTkRBVEUiOjE3MTE5MzQ4MDE2ODIsIkFOU0FQUElEIjoiZXNoZW5naHVvdGVzdCIsIkFOUyRERUJVRyI6MiwiQU5TVVBMT0FEVVJMIjoiaHR0cHM6Ly9lbGlmZS11cC5hbmFseXN5c2RhdGEuY29tLyIsIkZSSVNUREFZIjoiMjAyNDAzMjUiLCJGUklTVElNRSI6ZmFsc2UsIkFSS19MT0dJTklEIjoidE44YkVBWnRmZ0hVcUdQUHVYZjlTRCs4TEZRaVdyWUwiLCJBUktfSUQiOiJKUzQ4NTM5YTMyODZjYzc3ZTg1NmE4MTBmMTFiMTZkZWMzNDg1MyIsIkFSS0ZSSVNUUFJPRklMRSI6IjIwMjQtMDMtMjUgMDk6MTU6MzEuOTYyIn0%3D',
    'br-session-js-sdk': '16e7c451-5b0d-45e6-a8bd-8e4e3c185ff1|1711934790933|1711934799665|17',
    'OF_WEB_SESSION': '',
    'ARK_STARTUP': 'eyJTVEFSVFVQIjp0cnVlLCJTVEFSVFVQVElNRSI6IjIwMjQtMDQtMDEgMDk6MjY6MzEuMzEyIn0%3D',
    't_s_interactiveIGoChoose': '416085ece86cf6d90317d943eed6007d',
    'unionToken_interactiveIGoChoose': 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT0iLCJhY3Rpdml0eU5vIjoiIiwiYWNjb3VudCI6Ikp5dnErR3FMS2s5VjhnS2dndEhKUUE9PSIsInVzZXJJZCI6IjMzMTY0NjcwIiwibWVyY2hhbnRJZCI6IjAwMDAwMDAxOTEiLCJjdXN0b21lckluZm8iOiJ7XCJkZXZpY2VfaWRcIjpcIjQ4QkVEOUIyLTAwRjctNEU2OS1BODk3LTVGQkIzODdGM0E0RFwiLFwibG9naW5UeXBlXCI6XCJpbnRlcmFjdGl2ZUlHb0Nob29zZVwiLFwiY2l0eV9jb2RlXCI6XCIzMjAxMDBcIixcImNpc25vXCI6XCJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT1cIixcImlzTmV3VXNlclwiOlwiMFwiLFwibWFya2V0SWRcIjpcIk05MjMxNTYyODkwMTY2OTI3MzZcIixcImNpdHlfbmFtZVwiOlwi5Y2X5Lqs5biCXCIsXCJwaG9uZVwiOlwiMTU5NTEwMDMwNzhcIixcImZyb21FbnRyeVwiOlwiQVBQXCIsXCJjdXJyZW50VGltZU1pbGxpc1wiOlwiMTcxMTkzNDc5MDc4NVwiLFwidXNlclV1aWRcIjpcInROOGJFQVp0ZmdIVXFHUFB1WGY5U0QrOExGUWlXcllMXCIsXCJjdXN0X2lkXCI6XCJ0TjhiRUFadGZnSFVxR1BQdVhmOVNEKzhMRlFpV3JZTFwiLFwiaW52aXRhdGlvbkNvZGVcIjpcIlc0RlRHWFwifSIsImNpc25vIjoiSnl2cStHcUxLazlWOGdLZ2d0SEpRQT09IiwibG9naW5UeXBlIjoiaW50ZXJhY3RpdmVJR29DaG9vc2UiLCJ1bmlvbk1hcmtldElkIjoiTTkyMzE1NjI4OTAxNjY5MjczNiIsImlhdCI6MTcxMTkzNDc5MSwiZXhwIjoxNzExOTM2NTkxfQ.zSTj2C0WdyAdUR9fCfaX0jIiFpYsakNjdefuBTT6gvU',
    'unionToken_interactiveIGoChoose_loginParam': 'YWZzZ1RDZnNyYjJKSlVBUU8vVTNuNjd1Wkd3UXdtYmZ3THJkejBZWFZ6aEdJVVNHOWJWSDhCbmsxeEhKNjV1dXRjVCBWOTBWZGZhM2FsaFI4L1VpWTJoOGVOc0x5VG5jdWl3VWN2S01TVGxsUkZzSENxZVJxZmVtR0JnR0Y0cmkvbk1ITmJ1dkVMMG9TMnJVL1JFaEdCWUhMZFZyaUlYdVMgdFVYZXRKbUZzc1hKUzNRZk9ZcC9tM01sWiBVT0p6Nk9WdlB1bzVzcnhIMVVVYmx2eWhYN2NGdFZqUWtxQkkzRnpHcmp2OENGT1FvVFRrTE9YTVhvdnFaN2lDdlkyRFp3cUE1bUpwTUpsLzlFYmtqaFRMQTNmIFdvNzhoL1NpUldScENGaFhLc0F6ajF4R3M1IGRyRC9YNlpONUEvd2xrTFJDcXFVL3V4RDNrUTlKYjlKSzhUTlRidXNqV2xEdkxMNHExUDNRS25IdllGOXRjMHQ3Z3ZpY0FqRWV5bUlPZlFoRDRJWklsRSB1ZUhId1Q3ZXphcDBNMUoybXV1eWpsRzRzdlBwb0VVYVRPZ0dHZjdEMGxzcEx4T1Fvd2RhaXIxNTRpd2J4V1NTIG9qdUdDSk5GaFBvVXVqIFRObFZzL1BRMk91OXlTV3NNVGxySGZyWHVaNXFuS0xIUUwxa0NUaTBaa1BKNWFidkM0IDVzN2w3RnBEUnRNcEFHSFpzdCBTSGpuTWh2YThnVGdDMTgyZVRjdWhoTUV0bGs0REoydnpFU2hRVlBYVSA3eUpFUlZYN2hCakd5WksgQTZNViBvRWZmL0FyaFBwZzU4eGlJTU9HL21XajRsR29TQ2ZNa1QwZXpBT3UgbUVHbjNQdllZdHlJZXlTM0gzdUZJeDJianhMWTJlLzBjbksvcVRqUmR3TzBwVEt6IEdDMlJpRGtsU1RXWEM1TFVRLzNlcGpSbGJqd3g4aFV4c21YQkZWc1djeU9xQUVwbW9QYkxyZGw2L08vdlJZUWFHIFV5TC9T',
}

headers = {
    'Host': 'market-web.ofpay.com',
    'Accept': '*/*',
    'Authorization': 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT0iLCJhY3Rpdml0eU5vIjoiIiwiYWNjb3VudCI6Ikp5dnErR3FMS2s5VjhnS2dndEhKUUE9PSIsInVzZXJJZCI6IjMzMTY0NjcwIiwibWVyY2hhbnRJZCI6IjAwMDAwMDAxOTEiLCJjdXN0b21lckluZm8iOiJ7XCJkZXZpY2VfaWRcIjpcIjQ4QkVEOUIyLTAwRjctNEU2OS1BODk3LTVGQkIzODdGM0E0RFwiLFwibG9naW5UeXBlXCI6XCJpbnRlcmFjdGl2ZUlHb0Nob29zZVwiLFwiY2l0eV9jb2RlXCI6XCIzMjAxMDBcIixcImNpc25vXCI6XCJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT1cIixcImlzTmV3VXNlclwiOlwiMFwiLFwibWFya2V0SWRcIjpcIk05MjMxNTYyODkwMTY2OTI3MzZcIixcImNpdHlfbmFtZVwiOlwi5Y2X5Lqs5biCXCIsXCJwaG9uZVwiOlwiMTU5NTEwMDMwNzhcIixcImZyb21FbnRyeVwiOlwiQVBQXCIsXCJjdXJyZW50VGltZU1pbGxpc1wiOlwiMTcxMTkzNDc5MDc4NVwiLFwidXNlclV1aWRcIjpcInROOGJFQVp0ZmdIVXFHUFB1WGY5U0QrOExGUWlXcllMXCIsXCJjdXN0X2lkXCI6XCJ0TjhiRUFadGZnSFVxR1BQdVhmOVNEKzhMRlFpV3JZTFwiLFwiaW52aXRhdGlvbkNvZGVcIjpcIlc0RlRHWFwifSIsImNpc25vIjoiSnl2cStHcUxLazlWOGdLZ2d0SEpRQT09IiwibG9naW5UeXBlIjoiaW50ZXJhY3RpdmVJR29DaG9vc2UiLCJ1bmlvbk1hcmtldElkIjoiTTkyMzE1NjI4OTAxNjY5MjczNiIsImlhdCI6MTcxMTkzNDc5MSwiZXhwIjoxNzExOTM2NTkxfQ.zSTj2C0WdyAdUR9fCfaX0jIiFpYsakNjdefuBTT6gvU',
    'Sec-Fetch-Site': 'same-origin',
    'Accept-Language': 'zh-CN,zh-Hans;q=0.9',
    'Sec-Fetch-Mode': 'cors',
    'UUID': '1711934801686279FEU75',
    'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 F-OFST  elife_moblie_ios  fullversion:6.0.2  BSComponentVersion:5.4 WorkStationChannel:0 isBreak:0  ICBCiPhoneBSNew 6.0.2 iphone os wkwebview:true',
    'Referer': 'https://market-web.ofpay.com/h5/union/interactiveIGoChoose/index?loginParams=afsgTCfsrb2JJUAQO/U3n67uZGwQwmbfwLrdz0YXVzhGIUSG9bVH8Bnk1xHJ65uutcT+V90Vdfa3alhR8/UiY2h8eNsLyTncuiwUcvKMSTllRFsHCqeRqfemGBgGF4ri/nMHNbuvEL0oS2rU/REhGBYHLdVriIXuS+tUXetJmFssXJS3QfOYp/m3MlZ+UOJz6OVvPuo5srxH1UUblvyhX7cFtVjQkqBI3FzGrjv8CFOQoTTkLOXMXovqZ7iCvY2DZwqA5mJpMJl/9EbkjhTLA3f+Wo78h/SiRWRpCFhXKsAzj1xGs5+drD/X6ZN5A/wlkLRCqqU/uxD3kQ9Jb9JK8TNTbusjWlDvLL4q1P3QKnHvYF9tc0t7gvicAjEeymIOfQhD4IZIlE+ueHHwT7ezap0M1J2muuyjlG4svPpoEUaTOgGGf7D0lspLxOQowdair154iwbxWSS+ojuGCJNFhPoUuj+TNlVs/PQ2Ou9ySWsMTlrHfrXuZ5qnKLHQL1kCTi0ZkPJ5abvC4+5s7l7FpDRtMpAGHZst+SHjnMhva8gTgC182eTcuhhMEtlk4DJ2vzEShQVPXU+7yJERVX7hBjGyZK+A6MV+oEff/ArhPpg58xiIMOG/mWj4lGoSCfMkT0ezAOu+mEGn3PvYYtyIeyS3H3uFIx2bjxLY2e/0cnK/qTjRdwO0pTKz+GC2RiDklSTWXC5LUQ/3epjRlbjwx8hUxsmXBFVsWcyOqAEpmoPbLrdl6/O/vRYQaG+UyL/S',
    # 'Cookie': 'ARK_ID=JS48539a3286cc77e856a810f11b16dec34853; FZ_STROAGE.ofpay.com=eyJBUktTVVBFUiI6eyJncHNfY2l0eSI6IiIsInByb2plY3RfdHlwZSI6IueIsei0rTguOOa0u%2BWKqCJ9LCJTRUVTSU9OSUQiOiI0NmRkZGYwOTYyZWZhYjI1IiwiU0VFU0lPTkRBVEUiOjE3MTE5MzQ4MDE2ODIsIkFOU0FQUElEIjoiZXNoZW5naHVvdGVzdCIsIkFOUyRERUJVRyI6MiwiQU5TVVBMT0FEVVJMIjoiaHR0cHM6Ly9lbGlmZS11cC5hbmFseXN5c2RhdGEuY29tLyIsIkZSSVNUREFZIjoiMjAyNDAzMjUiLCJGUklTVElNRSI6ZmFsc2UsIkFSS19MT0dJTklEIjoidE44YkVBWnRmZ0hVcUdQUHVYZjlTRCs4TEZRaVdyWUwiLCJBUktfSUQiOiJKUzQ4NTM5YTMyODZjYzc3ZTg1NmE4MTBmMTFiMTZkZWMzNDg1MyIsIkFSS0ZSSVNUUFJPRklMRSI6IjIwMjQtMDMtMjUgMDk6MTU6MzEuOTYyIn0%3D; br-session-js-sdk=16e7c451-5b0d-45e6-a8bd-8e4e3c185ff1|1711934790933|1711934799665|17; OF_WEB_SESSION=; ARK_STARTUP=eyJTVEFSVFVQIjp0cnVlLCJTVEFSVFVQVElNRSI6IjIwMjQtMDQtMDEgMDk6MjY6MzEuMzEyIn0%3D; t_s_interactiveIGoChoose=416085ece86cf6d90317d943eed6007d; unionToken_interactiveIGoChoose=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT0iLCJhY3Rpdml0eU5vIjoiIiwiYWNjb3VudCI6Ikp5dnErR3FMS2s5VjhnS2dndEhKUUE9PSIsInVzZXJJZCI6IjMzMTY0NjcwIiwibWVyY2hhbnRJZCI6IjAwMDAwMDAxOTEiLCJjdXN0b21lckluZm8iOiJ7XCJkZXZpY2VfaWRcIjpcIjQ4QkVEOUIyLTAwRjctNEU2OS1BODk3LTVGQkIzODdGM0E0RFwiLFwibG9naW5UeXBlXCI6XCJpbnRlcmFjdGl2ZUlHb0Nob29zZVwiLFwiY2l0eV9jb2RlXCI6XCIzMjAxMDBcIixcImNpc25vXCI6XCJKeXZxK0dxTEtrOVY4Z0tnZ3RISlFBPT1cIixcImlzTmV3VXNlclwiOlwiMFwiLFwibWFya2V0SWRcIjpcIk05MjMxNTYyODkwMTY2OTI3MzZcIixcImNpdHlfbmFtZVwiOlwi5Y2X5Lqs5biCXCIsXCJwaG9uZVwiOlwiMTU5NTEwMDMwNzhcIixcImZyb21FbnRyeVwiOlwiQVBQXCIsXCJjdXJyZW50VGltZU1pbGxpc1wiOlwiMTcxMTkzNDc5MDc4NVwiLFwidXNlclV1aWRcIjpcInROOGJFQVp0ZmdIVXFHUFB1WGY5U0QrOExGUWlXcllMXCIsXCJjdXN0X2lkXCI6XCJ0TjhiRUFadGZnSFVxR1BQdVhmOVNEKzhMRlFpV3JZTFwiLFwiaW52aXRhdGlvbkNvZGVcIjpcIlc0RlRHWFwifSIsImNpc25vIjoiSnl2cStHcUxLazlWOGdLZ2d0SEpRQT09IiwibG9naW5UeXBlIjoiaW50ZXJhY3RpdmVJR29DaG9vc2UiLCJ1bmlvbk1hcmtldElkIjoiTTkyMzE1NjI4OTAxNjY5MjczNiIsImlhdCI6MTcxMTkzNDc5MSwiZXhwIjoxNzExOTM2NTkxfQ.zSTj2C0WdyAdUR9fCfaX0jIiFpYsakNjdefuBTT6gvU; unionToken_interactiveIGoChoose_loginParam=YWZzZ1RDZnNyYjJKSlVBUU8vVTNuNjd1Wkd3UXdtYmZ3THJkejBZWFZ6aEdJVVNHOWJWSDhCbmsxeEhKNjV1dXRjVCBWOTBWZGZhM2FsaFI4L1VpWTJoOGVOc0x5VG5jdWl3VWN2S01TVGxsUkZzSENxZVJxZmVtR0JnR0Y0cmkvbk1ITmJ1dkVMMG9TMnJVL1JFaEdCWUhMZFZyaUlYdVMgdFVYZXRKbUZzc1hKUzNRZk9ZcC9tM01sWiBVT0p6Nk9WdlB1bzVzcnhIMVVVYmx2eWhYN2NGdFZqUWtxQkkzRnpHcmp2OENGT1FvVFRrTE9YTVhvdnFaN2lDdlkyRFp3cUE1bUpwTUpsLzlFYmtqaFRMQTNmIFdvNzhoL1NpUldScENGaFhLc0F6ajF4R3M1IGRyRC9YNlpONUEvd2xrTFJDcXFVL3V4RDNrUTlKYjlKSzhUTlRidXNqV2xEdkxMNHExUDNRS25IdllGOXRjMHQ3Z3ZpY0FqRWV5bUlPZlFoRDRJWklsRSB1ZUhId1Q3ZXphcDBNMUoybXV1eWpsRzRzdlBwb0VVYVRPZ0dHZjdEMGxzcEx4T1Fvd2RhaXIxNTRpd2J4V1NTIG9qdUdDSk5GaFBvVXVqIFRObFZzL1BRMk91OXlTV3NNVGxySGZyWHVaNXFuS0xIUUwxa0NUaTBaa1BKNWFidkM0IDVzN2w3RnBEUnRNcEFHSFpzdCBTSGpuTWh2YThnVGdDMTgyZVRjdWhoTUV0bGs0REoydnpFU2hRVlBYVSA3eUpFUlZYN2hCakd5WksgQTZNViBvRWZmL0FyaFBwZzU4eGlJTU9HL21XajRsR29TQ2ZNa1QwZXpBT3UgbUVHbjNQdllZdHlJZXlTM0gzdUZJeDJianhMWTJlLzBjbksvcVRqUmR3TzBwVEt6IEdDMlJpRGtsU1RXWEM1TFVRLzNlcGpSbGJqd3g4aFV4c21YQkZWc1djeU9xQUVwbW9QYkxyZGw2L08vdlJZUWFHIFV5TC9T',
    'Sec-Fetch-Dest': 'empty',
}

params = {
    'awardId': 'W1190341661121970180',
    'goodsId': '',
    'invitationCode': '',
    'gameAccount': '15951003078',
    'eventVisitorId': 'RE_0e191ec92a24fd6770b3358ccee55553171132933146705598HLE',
}

def send_request():
    try:
        res = requests.get(url='https://market-web.ofpay.com/h5/union/api/draw/interactiveIGoChoose/A1190335340494454784',
                           headers=headers, cookies=cookies, params=params)
        print(res.text)
        return res
    except Exception as e:
        print(f"网络请求出错: {e}")
        return None


target_time = datetime.datetime(2024, 4, 1, 9, 30, 10)
time_diff = (target_time - datetime.datetime.now()).total_seconds()
if time_diff > 0:
    time.sleep(time_diff)

result = True

while result:
    response = send_request()
    if response is None:
        print('请求失败')
        time.sleep(1)
        continue
    if response.status_code != 200:
        print('请求失败')
        time.sleep(1)
        continue
    if response.text.find('本周名额已抢光') != -1:
        print('已经抢完')
        time.sleep(10)
    elif response.text.find('您存在待支付订单') != -1:
        print("抢购成功")
        exit()
    elif response.text.find('W1190341661121970180') != -1:
        print("抢购成功")
        exit()
    else:
        print('领取失败, 重新领取')
        time.sleep(10)
